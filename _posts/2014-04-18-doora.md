---
layout: post
title: Doora
---

当我第N次面临“把电脑上的文件传到手机”的困境的时候，我决定解决这个问题。

想了想，我需要的是一个很简单的网站，能快速的打开，拖拽上传，生成一个二维码，手机扫描下载。但是好像还没看到完全符合这个条件的网站（虽然我觉得肯定有...），于是就开始自己写了。

第二天，有了 [Doora](http://lab.wong2.me/doora/)

### 名字

Doora，哆啦A梦，任意门，传送。。。感受一下。

### 七牛

上传后的文件是存在七牛上的，主要是为了提供比较好的下载速度，而且之前七牛搞活动的时候充过一些钱，不用白不用。
不过七牛的文档...，半天都找不到想找的内容，Python SDK的接口也不太友好。

### 过期

不过七牛没有提供设定文件上传后多久删除的功能，只能自己实现了。
现在的方案是通过[rq-scheduler](https://github.com/ui/rq-scheduler)，上传后30分钟后，把文件的key放入删除队列里，然后由`rqworker`来消费删除。

### 速度

为了加快页面显示速度，尽可能减少了阻塞的css和js文件，现在只会加载一个css，由内嵌在HTML里的`load.js`来异步加载其它js，引用的静态都是放在<http://www.staticfile.org/> CDN上的。

### 源码

<https://github.com/wong2/doora>
